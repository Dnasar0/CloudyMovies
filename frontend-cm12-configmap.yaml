apiVersion: v1
data:
  gameScreen.html: "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Your Movie</title>\n    <style>\n        /* Basic layout styles */\n        body {\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            padding: 20px;\n            font-family: Arial, sans-serif;\n            height: 100vh;\n            margin: 0;\n        }\n        .account-button {\n            position: absolute;\n            top: 20px;\n            right: 20px;\n            padding: 10px 20px;\n            background-color: #28a745;\n            color: white;\n            border: none;\n            cursor: pointer;\n            border-radius: 5px;\n            transition: background-color 0.3s;\n        }\n        .account-button:hover {\n            background-color: #218838;\n        }\n\n        .container {\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            gap: 40px; /* Space between left movie, center buttons, and right movie */\n        }\n        .movie-container {\n            max-width: 30%;\n            text-align: center;\n        }\n        .movie-info {\n            margin-bottom: 20px;\n        }\n        .movie-poster {\n            max-width: 100%;\n            height: auto;\n            border: 1px solid #ccc;\n            margin-top: 10px;\n        }\n        .movie-rating {\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            gap: 10px;\n            margin-top: 10px;\n        }\n        .score {\n            font-size: 24px;\n            font-weight: bold;\n        }\n        .buttons {\n            display: flex;\n            gap: 10px;\n            margin-top: 20px;\n        }\n        .button {\n            padding: 10px 20px;\n            background-color: #007BFF;\n            color: white;\n            border: none;\n            cursor: pointer;\n            border-radius: 5px;\n            transition: background-color 0.3s;\n        }\n        .button:hover {\n            background-color: #0056b3;\n        }\n        /* Initially hide movie2 rating */\n        .hidden-rating {\n            display: none;\n            font-size: 18px;\n            font-weight: bold;\n            color: red;\n        }\n    </style>\n</head>\n<body>\n    <button class=\"account-button\" onclick=\"showAccount()\">Account</button>\n    <div class=\"container\">\n        <!-- Left Movie -->\n        <div class=\"movie-container\">\n            <h1>Your movie is:</h1>\n            <div class=\"movie1-info\">\n                <h1 id=\"movie1Id\" style=\"display: none;\">{{movie1.movieId}}</h1>\n                <h2>{{ movie1.title }} ({{ movie1.year }})({{movie1.movieId}})</h2\n                <p><strong>Genre:</strong> {{ movie1.genre }}</p>\n                <p><strong>Rating:</strong> <span id=\"movie1Rating\">{{movie1.rating}}</span></p>\n                <img src=\"{{ movie1.poster }}\"  onclick=\"details(document.getElementById('movie1Id').textContent)\" alt=\"Movie1 Poster\" class=\"movie1-poster\">\n            </div>\n        </div>\n\n        <!-- Score and Buttons in the Middle -->\n        <div class=\"movie-rating\">\n            <span id=\"hidden-text\" class=\"hidden-text\"></span>\n            <span class=\"score\" id=\"score\">Your score : </span>\n            <span id=\"movie2Rating\" class=\"hidden-rating\">{{ movie2.rating }}</span>\n            <div class=\"buttons\", id=\"game-buttons\">\n                <button class=\"button\" onclick=\"choice('Higher')\">Higher</button>\n                <button class=\"button\" onclick=\"choice('Lower')\">Lower</button>\n            </div>\n            <div class=\"buttons\", id=\"next-button\", style=\"display: none;\">\n                <button id=\"nextMovie\" class=\"button\" onclick=\"nextMovie()\">Next Movie</button>\n            </div>\n            \n        </div>\n\n        <!-- Right Movie -->\n        <div class=\"movie2-container\">\n            <h1>Your movie is (again):</h1>\n            <div class=\"movie2-info\">\n            <h1 id=\"movie2Id\" style=\"display: none;\">{{movie2.movieId}}</h1>\n                <h2>{{ movie2.title }} ({{ movie2.year }})</h2>\n                <p><strong>Genre:</strong> {{ movie2.genre }}</p>\n                <p><strong>Rating:</strong> <span id=\"ratingPlaceholder\">???</span></p>\n                <img src=\"{{ movie2.poster }}\" onclick=\"details(document.getElementById('movie2Id').textContent)\" alt=\"Movie2 Poster\" class=\"movie2-poster\">\n            </div>\n        </div>\n    </div>\n    <script>\n\n        let username = localStorage.getItem(\"loggedInUser\");\n        let score = 0;\n        let hasplayed = false;\n        let won = false; \n    \n        function choice(choice) {\n            if (hasplayed) {\n                alert(\"You have already played this round. Click 'Next Movie'.\");\n                return;\n            }\n            hasplayed = true;\n    \n            const movie1Rating = parseFloat(document.getElementById(\"movie1Rating\").textContent);\n            const movie2Rating = parseFloat(document.getElementById(\"movie2Rating\").textContent);\n            document.getElementById(\"ratingPlaceholder\").textContent = document.getElementById(\"movie2Rating\").textContent;\n    \n            let correctChoice = (choice === \"Higher\" && movie2Rating > movie1Rating) || (choice === \"Lower\" && movie2Rating < movie1Rating || movie2Rating === movie1Rating);\n            console.log( \"Your choice: \" + choice + \", Movie 1 rating: \" + movie1Rating + \", Movie 2 rating: \" + movie2Rating);\n            \n            if (correctChoice) {\n                score++;\n                document.getElementById(\"hidden-text\").textContent = \"✅ Correct!\";\n                document.getElementById(\"nextMovie\").textContent = \"Next Movie!\";\n                won = true;\n            } else {\n                \n                document.getElementById(\"hidden-text\").textContent = \"❌ Incorrect!\";\n                document.getElementById(\"nextMovie\").textContent = \"Try Again!\";\n                updateHighScore(); // Update high score if the user lost\n                score = 0; // Reset score if the user loses\n            }\n\n            document.getElementById(\"score\").textContent = \"Your score: \" + score;\n    \n            document.getElementById(\"next-button\").style.display = \"block\";\n            document.getElementById(\"game-buttons\").style.display = \"none\";\n        }\n    \n        function updateHighScore() {\n            if (!username) {\n                console.error(\"No logged-in user found.\");\n                return;\n            }\n    \n            fetch(\"/updateHighScore\", {\n                method: \"POST\",\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify({\n                    username: username,\n                    highScore: score\n                })\n            })\n            .then(response => response.json())\n            .then(data => {\n                console.log(\"High Score Updated:\", data);\n            })\n            .catch(error => console.error(\"Error updating high score:\", error));\n        }      \n\n        function nextMovie() {\n            if (!hasplayed) {\n                alert(\"Please make a choice before proceeding to the next movie.\");\n                return;\n            }\n            hasplayed = false;\n            \n            document.getElementById(\"hidden-text\").textContent = \"\U0001F504 Loading new movie...\";\n\n            document.getElementById(\"game-buttons\").style.display = \"none\"; // Hide buttons\n            document.getElementById(\"next-button\").style.display = \"none\"; // Hide next button\n            // Fetch a new random movie\n            fetch('/getRandom')\n                .then(response => response.json())  // Parse response as JSON\n                .then(newMovie => {\n                    // Move movie2 to movie1\n                    document.querySelector(\".movie1-info h2\").textContent = `${document.querySelector(\".movie2-info h2\").textContent}`;\n                    document.querySelector(\".movie1-info p strong\").textContent = `${document.querySelector(\".movie2-info p strong\").textContent}`;\n                    document.querySelector(\".movie1-poster\").src = document.querySelector(\".movie2-poster\").src;\n                    document.getElementById(\"movie1Rating\").textContent = document.getElementById(\"movie2Rating\").textContent;\n                    document.getElementById(\"movie1Id\").textContent = document.getElementById(\"movie2Id\").textContent;\n                    \n                    // Set new movie2 data\n                    document.querySelector(\".movie2-info h2\").textContent = `${newMovie.title} (${newMovie.year})`;\n                    document.querySelector(\".movie2-poster\").src = newMovie.poster;\n                    document.getElementById(\"movie2Rating\").textContent = newMovie.rating;\n                    document.getElementById(\"ratingPlaceholder\").textContent = \"???\"; // Hide rating again\n                    document.getElementById(\"movie2Id\").textContent = newMovie.id; // Set movie2 ID\n                    \n                    // Hide movie2 rating again for the new round\n                    document.getElementById(\"movie2Rating\").style.display = \"none\";\n                })\n                .catch(error => console.error(\"Error fetching new movie:\", error))\n                .finally(() => {\n                    document.getElementById(\"hidden-text\").textContent = \"\"; // Clear the hidden text\n                    document.getElementById(\"game-buttons\").style.display = \"block\"; // Show the game buttons again\n                    document.getElementById(\"next-button\").style.display = \"none\"; // Hide the next button again\n                });\n                \n        }        \n\n        function details(id) {\n            if (!hasplayed) {\n                alert(\"You have to play the game first before you can see the details of the movie.\");\n                return;\n            }\n            window.open('/get/' + id, '_blank');\n        }\n\n        function showAccount(){\n            window.open('/account/' + username, '_blank');\n        }\n\n    </script>\n</body>\n</html>\n"
kind: ConfigMap
metadata:
  annotations:
    use-subpath: "true"
  labels:
    io.kompose.service: frontend
  name: frontend-cm12
